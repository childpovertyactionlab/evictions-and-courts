st_cast("POLYGON") %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
mutate(shell = j) %>%
st_combine() %>%
st_cast("POLYGON")
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
st_combine() %>%
st_cast("POLYGON")
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
shape <- do.call(rbind, final_shells)
print(class(shape))
# %>%
#   st_combine() %>%
#   st_cast("POLYGON") %>%
#   mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
mutate(shell = j) %>%
st_combine() %>%
st_cast("POLYGON")
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
st_combine() %>%
st_cast("POLYGON")
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
shape <- do.call(rbind, final_shells)
print(shape)
# %>%
#   st_combine() %>%
#   st_cast("POLYGON") %>%
#   mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
shape <- do.call(rbind, final_shells) %>%
st_as_sf() %>%
st_combine() %>%
st_cast("POLYGON") %>%
mutate(search_id = isochrones$results$search_id[[i]])
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
mutate(shell = j) %>%
st_combine() %>%
st_cast("POLYGON")
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
st_combine() %>%
st_cast("POLYGON")
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
shape <- do.call(rbind, final_shells) %>%
st_as_sf() %>%
st_combine() %>%
st_cast("POLYGON") %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
View(shape)
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
mutate(shell = j) %>%
st_combine()
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
st_combine()
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
shape <- do.call(rbind, final_shells) %>%
st_as_sf() %>%
st_combine() %>%
st_cast("POLYGON") %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
mutate(shell = j) %>%
st_combine()
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
st_combine()
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
print(final_shells)
shape <- do.call(rbind, final_shells) %>%
st_as_sf() %>%
st_combine() %>%
st_cast("POLYGON") %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
final_shapes <- tibble()
final_shells <- tibble()
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
mutate(shell = j) %>%
st_combine()
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
st_combine()
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
class(final_shells)
shape <- do.call(rbind, final_shells) %>%
st_as_sf() %>%
st_combine() %>%
st_cast("POLYGON") %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
View(final_shells)
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
mutate(shell = j) %>%
st_combine()
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
st_combine()
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[j] <- shell
}
class(final_shells)
shape <- do.call(rbind, final_shells) %>%
st_as_sf() %>%
st_combine() %>%
st_cast("POLYGON") %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
final_shapes <- tibble()
final_shells <- tibble()
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
mutate(shell = j) %>%
st_combine()
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
st_combine()
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[j] <- shell
}
class(final_shells)
shape <- do.call(rbind, final_shells) %>%
st_as_sf() %>%
st_combine() %>%
st_cast("POLYGON") %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
mutate(shell = j) %>%
st_combine() %>%
st_cast("POLYGON")
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
st_combine() %>%
st_cast("POLYGON")
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
class(final_shells)
shape <- do.call(rbind, final_shells) %>%
st_as_sf() %>%
st_combine() %>%
st_cast("POLYGON") %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
final_shapes <- list()
final_shells <- list()
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
mutate(shell = j) %>%
st_combine() %>%
st_cast("POLYGON")
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
st_combine() %>%
st_cast("POLYGON")
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
class(final_shells)
shape <- do.call(rbind, final_shells) %>%
st_as_sf() %>%
st_combine() %>%
st_cast("POLYGON") %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
View(final_shells)
shell <- isochrones$results$shapes[[9]]$shell[[6]] %>%
st_as_sf(coords = c("lng", "lat"), crs = 4326) %>%
mutate(n = 6,
search_id = isochrones$results$search_id[[9]],
type = "shell") %>%
group_by(search_id, type) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
shell <- isochrones$results$shapes[[9]]$shell[[6]] %>%
st_as_sf(coords = c("lng", "lat"), crs = 4326) %>%
st_combine() %>%
st_cast("POLYGON")
View(shell)
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
class(final_shells)
shape <- do.call(rbind, final_shells) %>%
st_as_sf() %>%
st_combine() %>%
st_cast("POLYGON") %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
final_shapes <- list()
final_shells <- list()
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
class(final_shells)
shape <- do.call(rbind, final_shells) %>%
st_as_sf() %>%
st_combine() %>%
st_cast("POLYGON") %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
View(final_shells)
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
class(final_shells)
shape <- bind_rows(final_shells) %>%
mutate(search_id = isochrones$results$search_id[[i]])
st_combine() %>%
st_cast("POLYGON")
final_shapes[[i]] <- shape
final_shells <- list()
}
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
class(final_shells)
shape <- bind_rows(final_shells) %>%
mutate(search_id = isochrones$results$search_id[[i]])
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
final_shapes[[i]] <- shape
final_shells <- list()
}
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
class(final_shells)
shape <- bind_rows(final_shells) %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
View(final_shapes)
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
class(final_shells)
shape <- bind_rows(final_shells) %>%
st_cast("MULTIPOLYGON") %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
class(final_shells)
shape <- bind_rows(final_shells) %>%
st_cast("POLYGON") %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
# Process each shape
for (i in seq_along(isochrones$results$shapes)) {
# Process each shell in the shape
for (j in seq_along(isochrones$results$shapes[[i]]$shell)) {
shell <- st_as_sf(isochrones$results$shapes[[i]]$shell[[j]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Process each hole in the shell
for (k in seq_along(isochrones$results$shapes[[i]]$hole[[j]])) {
hole <- st_as_sf(isochrones$results$shapes[[i]]$hole[[j]][[k]], coords = c("lng", "lat"), crs = 4326) %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON")
# Subtract hole from shell
shell <- st_difference(shell, hole)
}
# Add the processed shell to the final_shapes list
final_shells[[j]] <- shell
}
class(final_shells)
shape <- bind_rows(final_shells) %>%
summarize_all(first) %>%
mutate(search_id = isochrones$results$search_id[[i]])
final_shapes[[i]] <- shape
final_shells <- list()
}
final_sdf <- bind_rows(final_shapes)
View(final_sdf)
final_sdf <- bind_rows(final_shapes)
